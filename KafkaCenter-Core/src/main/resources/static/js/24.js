(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{898:function(e,t,r){"use strict";var a=r(385),n=r(270),o=r(38),i=r(12),l=r(89),c=r(16),s=r(156),u=r(69),f=r(82),p=r(21),h=r(134),d=r(47),y=r(1),m=r.n(y),b=r(23),S=r(105);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function C(e,t){return(C=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function D(e){var t=F();return function r(){var a=V(e),n;if(t){var o=V(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return x(this,n)}}function x(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var k=d.a.Row,j=d.a.Col,_=function(e){O(r,e);var t=D(r);function r(e){var a;v(this,r),(a=t.call(this,e)).componentWillUnmount=function(){a.mounted=!1},a.arrayIsEqual=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1){var a=JSON.stringify(e[r]),n=JSON.stringify(t[r]);if(0!==a.localeCompare(n))return!1}return!0},a.refreshTableData=function(e){a.props.refreshTableData(e)},a.getCluster=function(){var e=[{value:"-1",label:"ALL"}];b.a.get("/monitor/cluster").then((function(t){if(200===t.data.code){var r=t.data.data[0].id,n=t.data.data[0].name,o=a.state.clusterValue;t.data.data.forEach((function(t){t.id<r&&(r=t.id,n=t.name),e.push({value:t.id,label:t.name})}));var i=Object(S.a)(a.props.id).id;if(null!=i?a.props.refreshDataSource(i):a.props.refreshDataSource(r),void 0===o&&"settingUser"!==a.props.id&&"settingTeam"!==a.props.id){var l={id:r,cluster:n,isAll:!1};Object(S.d)(a.props.id,l),o=n}a.setState({clusterSelectData:e,clusterValue:o})}})).catch((function(e){console.error("error",e),void 0!==e.response&&void 0!==e.response.status&&""!==e.response.status&&null!=e.response.status&&null!=e.response.status&&(401===e.response.status?p.a.error({content:"Please login!",closeable:!0}):p.a.error({content:"get cluster faily!",duration:1e4,closeable:!0}))}))},a.handleClusterFilterChange=function(e,t){a.props.refreshDataSource(t.value);var r=a.state.dataSource;e=t.label.toString();var n={id:t.value,cluster:t.label,isAll:!1};"-1"===t.value&&(n.isAll=!0),Object(S.d)(a.props.id,n);var o=a.filterByPara(r,a.state.clusterField,e,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue);a.setState({clusterValue:e}),a.refreshTableData(o)},a.handleFilterChange=function(e){e=e.toString();var t=a.state.dataSource,r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,e,a.state.switchField,a.state.switchValue);a.setState({searchValue:e}),a.refreshTableData(r),a.setSesion("".concat(a.props.id,"Search"),e)},a.onSwitchChange=function(e){var t=a.state.dataSource,r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,e);a.setState({switchValue:e}),a.refreshTableData(r),a.setSesion("".concat(a.props.id,"Switch"),e)},a.setSesion=function(e,t){void 0!==e&&sessionStorage.setItem(e,t)},a.initData=function(e){var t=JSON.parse(JSON.stringify(e)),r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue);a.setState({dataSource:t}),a.refreshTableData(r)},a.filterByPara=function(e,t,r,n,o,i,l){var c=JSON.parse(JSON.stringify(e));return a.isNullOrEmptyStr(i)||l&&"false"!==l||(c=c.filter((function(e){return!e[i].startsWith("_")}))),a.isNullOrEmptyStr(r)||"ALL"===r||(c=a.searchdata(c,t,r)),a.isNullOrEmptyStr(o)||(c=a.searchdata(c,n,o)),c},a.searchdata=function(e,t,r){var a=t.split(",");return e.filter((function(e){for(var t=!1,n=0,o=a.length;n<o;n+=1){for(var i=a[n].split("."),l=e,c=0,s=i.length;c<s;c+=1)l=l[i[c]];if(-1!==l.toLocaleLowerCase().search(r.toLocaleLowerCase())){t=!0;break}}return t}))},a.isNullOrEmptyStr=function(e){return null==e||""===e},a.selectView=function(e){return m.a.createElement(j,{align:"center"},m.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),m.a.createElement(u.a,{showSearch:!0,dataSource:a.state.clusterSelectData,placeholder:"please select cluster",style:{width:"300px"},onChange:function e(t,r,n){a.handleClusterFilterChange(t,n)},value:a.state.clusterValue}))},a.filterView=function(e,t){return m.a.createElement(j,{align:"center"},m.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),m.a.createElement(c.a,{placeholder:a.isNullOrEmptyStr(t)?"Input filter value":t,hasClear:!0,onChange:a.handleFilterChange,style:{width:"300px"},value:a.state.searchValue}))},a.parseBoolean=function(e){return"true"===e||"TRUE"===e||"True"===e||"false"!==e&&"FALSE"!==e&&"False"!==e&&void 0},a.getFilterData=function(e){var t=JSON.parse(JSON.stringify(e)),r;return a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue)},a.switchView=function(){var e=a.state.switchValue;return"string"==typeof a.state.switchValue&&(e=a.parseBoolean(a.state.switchValue.trim())),m.a.createElement(j,{align:"center"},m.a.createElement("div",{style:{display:"flex"}},m.a.createElement("span",{style:R.special},"Include special topic:\xa0\xa0"),m.a.createElement(n.a,{onChange:a.onSwitchChange,checked:e,defaultChecked:e,checkedChildren:m.a.createElement(i.a,{type:"select",size:"xs"}),unCheckedChildren:m.a.createElement(i.a,{type:"close",size:"xs"})})))},void 0!==a.props.onRef&&a.props.onRef(P(a));var o=sessionStorage.getItem("".concat(a.props.id,"Search")),l=sessionStorage.getItem("".concat(a.props.id,"Switch"));return a.state={dataSource:a.props.dataSource,clusterSelectData:[],clusterValue:Object(S.a)(a.props.id).cluster,clusterField:a.props.selectField,searchValue:null===o?"":o,searchField:a.props.searchField,switchField:a.props.switchField,switchValue:null!==l&&l},a}return E(r,[{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"componentDidMount",value:function e(){this.getCluster()}},{key:"componentWillReceiveProps",value:function e(t){this.validateCondition(this.state.dataSource,t.dataSource)&&(this.setState({dataSource:t.dataSource}),this.initData(t.dataSource))}},{key:"validateCondition",value:function e(t,r){return(null!=t||null!=r)&&((void 0!==t||void 0!==r)&&((0!==t.length||0!==r.length)&&(!this.arrayIsEqual(t,r)&&t!==r)))}},{key:"render",value:function e(){var t=this.props.selectTitle,r=this.props.searchTitle,a=this.props.searchPlaceholder,n=this.isNullOrEmptyStr(t)?"":this.selectView(t),o=this.isNullOrEmptyStr(r)?"":this.filterView(r,a),i=this.isNullOrEmptyStr(this.props.otherComponent)?"":this.props.otherComponent,l=this.isNullOrEmptyStr(this.props.switchField)?"":this.switchView();return m.a.createElement(k,{style:R.row},n,o,i,l)}}]),r}(y.Component),R={row:{margin:"20px 4px 20px"},special:{fontFamily:'Roboto, "Helvetica Neue", Helvetica, Tahoma, Arial, "PingFang SC", "Microsoft YaHei"',fontSize:"12px",lineHeight:"1.28571",color:"#333333",alignSelf:"center",fontWeight:"600"}},I=t.a=_},976:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),o=r(68),i=r.n(o),l=r(158),c=r(90),s=r(42),u=r(200),f=r(22),p=r(82),h=r(21),d=r(384),y=r(269),m=r(898),b=r(105),S=r(23);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function C(e,t){return(C=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function D(e){var t=F();return function r(){var a=V(e),n;if(t){var o=V(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return x(this,n)}}function x(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var k=function(e){O(r,e);var t=D(r);function r(){var e;v(this,r);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={isLoading:!1,dataSource:[],filterDataSource:[],pageData:[]},e.componentWillUnmount=function(){e.mounted=!1},e.fetchData=function(t){e.setState({isLoading:!0},(function(){S.a.get("/manager/broker?cluster=".concat(t)).then((function(t){if(200===t.data.code){var r=t.data.data;e.mounted&&e.setState({dataSource:r,filterDataSource:r,isLoading:!1})}else h.a.error({content:null==t.data.message?"server has error.":t.data.message,duration:1e4,closeable:!0})})).catch((function(t){e.setState({isLoading:!1}),console.error(t),h.a.error({content:"server has error.",duration:1e4,closeable:!0})}))}))},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.redrawPageData=function(t){e.setState({pageData:t})},e}return E(r,[{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"render",value:function e(){var t=this.state,r=t.isLoading,a=t.pageData,o=t.filterDataSource;return n.a.createElement("div",null,n.a.createElement(s.a,{visible:r,style:j.loading},n.a.createElement(m.a,{dataSource:this.state.dataSource,refreshTableData:this.refreshTableData,refreshDataSource:this.fetchData,selectTitle:"Cluster",selectField:"clusterName",id:"kafkaManagerBroker"}),n.a.createElement(f.a,{dataSource:a,hasBorder:!1},n.a.createElement(f.a.Column,{title:"Cluster",dataIndex:"clusterName"}),n.a.createElement(f.a.Column,{title:"Id",dataIndex:"id",cell:function e(t,r,a){return a.brokerInfo.bid}}),n.a.createElement(f.a.Column,{title:"Host",dataIndex:"host",cell:function e(t,r,a){return a.brokerInfo.host}}),n.a.createElement(f.a.Column,{title:"Port",dataIndex:"port",cell:function e(t,r,a){return a.brokerInfo.port}}),n.a.createElement(f.a.Column,{title:"Topics",dataIndex:"topics"}),n.a.createElement(f.a.Column,{title:"Partitions",dataIndex:"partitions"}),n.a.createElement(f.a.Column,{title:"Partitions as Leader",dataIndex:"partitionsAsLeader"}),n.a.createElement(f.a.Column,{title:"Messages",dataIndex:"messages",cell:d.h}),n.a.createElement(f.a.Column,{title:"Bytes In",dataIndex:"bytesIn",cell:d.b}),n.a.createElement(f.a.Column,{title:"Bytes Out",dataIndex:"bytesOut",cell:d.b})),n.a.createElement(y.a,{dataSource:o,redrawPageData:this.redrawPageData})))}}]),r}(a.Component),j={container:{margin:"20px",padding:"10px 20px 20px"},loading:{width:"100%"}};function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t,r){return t&&I(e.prototype,t),r&&I(e,r),e}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}function L(e,t){return(L=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function B(e){var t=W();return function r(){var a=M(e),n;if(t){var o=M(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return J(this,n)}}function J(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var H=function(e){N(r,e);var t=B(r);function r(){return R(this,r),t.apply(this,arguments)}return T(r,[{key:"render",value:function e(){var t=[{link:"",text:"Kafka Manager"},{link:"",text:"Broker"}];return n.a.createElement("div",null,n.a.createElement(l.a,{items:t,title:"Broker"}),n.a.createElement(i.a,{style:U.container},n.a.createElement(k,null)))}}]),r}(a.Component),U={container:{margin:"20px",padding:"10px 20px 20px",minHeight:"600px"}},z=t.default=H}}]);