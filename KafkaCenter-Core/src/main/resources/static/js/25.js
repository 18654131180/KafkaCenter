(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{898:function(e,t,r){"use strict";var n=r(385),a=r(270),o=r(38),i=r(12),l=r(89),c=r(16),s=r(156),u=r(69),f=r(82),p=r(21),h=r(134),d=r(47),m=r(1),y=r.n(m),g=r(23),b=r(105);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}function D(e,t){return(D=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function C(e){var t=j();return function r(){var n=x(e),a;if(t){var o=x(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return P(this,a)}}function P(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?F(e):t}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var k=d.a.Row,R=d.a.Col,L=function(e){E(r,e);var t=C(r);function r(e){var n;S(this,r),(n=t.call(this,e)).componentWillUnmount=function(){n.mounted=!1},n.arrayIsEqual=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1){var n=JSON.stringify(e[r]),a=JSON.stringify(t[r]);if(0!==n.localeCompare(a))return!1}return!0},n.refreshTableData=function(e){n.props.refreshTableData(e)},n.getCluster=function(){var e=[{value:"-1",label:"ALL"}];g.a.get("/monitor/cluster").then((function(t){if(200===t.data.code){var r=t.data.data[0].id,a=t.data.data[0].name,o=n.state.clusterValue;t.data.data.forEach((function(t){t.id<r&&(r=t.id,a=t.name),e.push({value:t.id,label:t.name})}));var i=Object(b.a)(n.props.id).id;if(null!=i?n.props.refreshDataSource(i):n.props.refreshDataSource(r),void 0===o&&"settingUser"!==n.props.id&&"settingTeam"!==n.props.id){var l={id:r,cluster:a,isAll:!1};Object(b.d)(n.props.id,l),o=a}n.setState({clusterSelectData:e,clusterValue:o})}})).catch((function(e){console.error("error",e),void 0!==e.response&&void 0!==e.response.status&&""!==e.response.status&&null!=e.response.status&&null!=e.response.status&&(401===e.response.status?p.a.error({content:"Please login!",closeable:!0}):p.a.error({content:"get cluster faily!",duration:1e4,closeable:!0}))}))},n.handleClusterFilterChange=function(e,t){n.props.refreshDataSource(t.value);var r=n.state.dataSource;e=t.label.toString();var a={id:t.value,cluster:t.label,isAll:!1};"-1"===t.value&&(a.isAll=!0),Object(b.d)(n.props.id,a);var o=n.filterByPara(r,n.state.clusterField,e,n.state.searchField,n.state.searchValue,n.state.switchField,n.state.switchValue);n.setState({clusterValue:e}),n.refreshTableData(o)},n.handleFilterChange=function(e){e=e.toString();var t=n.state.dataSource,r=n.filterByPara(t,n.state.clusterField,n.state.clusterValue,n.state.searchField,e,n.state.switchField,n.state.switchValue);n.setState({searchValue:e}),n.refreshTableData(r),n.setSesion("".concat(n.props.id,"Search"),e)},n.onSwitchChange=function(e){var t=n.state.dataSource,r=n.filterByPara(t,n.state.clusterField,n.state.clusterValue,n.state.searchField,n.state.searchValue,n.state.switchField,e);n.setState({switchValue:e}),n.refreshTableData(r),n.setSesion("".concat(n.props.id,"Switch"),e)},n.setSesion=function(e,t){void 0!==e&&sessionStorage.setItem(e,t)},n.initData=function(e){var t=JSON.parse(JSON.stringify(e)),r=n.filterByPara(t,n.state.clusterField,n.state.clusterValue,n.state.searchField,n.state.searchValue,n.state.switchField,n.state.switchValue);n.setState({dataSource:t}),n.refreshTableData(r)},n.filterByPara=function(e,t,r,a,o,i,l){var c=JSON.parse(JSON.stringify(e));return n.isNullOrEmptyStr(i)||l&&"false"!==l||(c=c.filter((function(e){return!e[i].startsWith("_")}))),n.isNullOrEmptyStr(r)||"ALL"===r||(c=n.searchdata(c,t,r)),n.isNullOrEmptyStr(o)||(c=n.searchdata(c,a,o)),c},n.searchdata=function(e,t,r){var n=t.split(",");return e.filter((function(e){for(var t=!1,a=0,o=n.length;a<o;a+=1){for(var i=n[a].split("."),l=e,c=0,s=i.length;c<s;c+=1)l=l[i[c]];if(-1!==l.toLocaleLowerCase().search(r.toLocaleLowerCase())){t=!0;break}}return t}))},n.isNullOrEmptyStr=function(e){return null==e||""===e},n.selectView=function(e){return y.a.createElement(R,{align:"center"},y.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),y.a.createElement(u.a,{showSearch:!0,dataSource:n.state.clusterSelectData,placeholder:"please select cluster",style:{width:"300px"},onChange:function e(t,r,a){n.handleClusterFilterChange(t,a)},value:n.state.clusterValue}))},n.filterView=function(e,t){return y.a.createElement(R,{align:"center"},y.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),y.a.createElement(c.a,{placeholder:n.isNullOrEmptyStr(t)?"Input filter value":t,hasClear:!0,onChange:n.handleFilterChange,style:{width:"300px"},value:n.state.searchValue}))},n.parseBoolean=function(e){return"true"===e||"TRUE"===e||"True"===e||"false"!==e&&"FALSE"!==e&&"False"!==e&&void 0},n.getFilterData=function(e){var t=JSON.parse(JSON.stringify(e)),r;return n.filterByPara(t,n.state.clusterField,n.state.clusterValue,n.state.searchField,n.state.searchValue,n.state.switchField,n.state.switchValue)},n.switchView=function(){var e=n.state.switchValue;return"string"==typeof n.state.switchValue&&(e=n.parseBoolean(n.state.switchValue.trim())),y.a.createElement(R,{align:"center"},y.a.createElement("div",{style:{display:"flex"}},y.a.createElement("span",{style:V.special},"Include special topic:\xa0\xa0"),y.a.createElement(a.a,{onChange:n.onSwitchChange,checked:e,defaultChecked:e,checkedChildren:y.a.createElement(i.a,{type:"select",size:"xs"}),unCheckedChildren:y.a.createElement(i.a,{type:"close",size:"xs"})})))},void 0!==n.props.onRef&&n.props.onRef(F(n));var o=sessionStorage.getItem("".concat(n.props.id,"Search")),l=sessionStorage.getItem("".concat(n.props.id,"Switch"));return n.state={dataSource:n.props.dataSource,clusterSelectData:[],clusterValue:Object(b.a)(n.props.id).cluster,clusterField:n.props.selectField,searchValue:null===o?"":o,searchField:n.props.searchField,switchField:n.props.switchField,switchValue:null!==l&&l},n}return O(r,[{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"componentDidMount",value:function e(){this.getCluster()}},{key:"componentWillReceiveProps",value:function e(t){this.validateCondition(this.state.dataSource,t.dataSource)&&(this.setState({dataSource:t.dataSource}),this.initData(t.dataSource))}},{key:"validateCondition",value:function e(t,r){return(null!=t||null!=r)&&((void 0!==t||void 0!==r)&&((0!==t.length||0!==r.length)&&(!this.arrayIsEqual(t,r)&&t!==r)))}},{key:"render",value:function e(){var t=this.props.selectTitle,r=this.props.searchTitle,n=this.props.searchPlaceholder,a=this.isNullOrEmptyStr(t)?"":this.selectView(t),o=this.isNullOrEmptyStr(r)?"":this.filterView(r,n),i=this.isNullOrEmptyStr(this.props.otherComponent)?"":this.props.otherComponent,l=this.isNullOrEmptyStr(this.props.switchField)?"":this.switchView();return y.a.createElement(k,{style:V.row},a,o,i,l)}}]),r}(m.Component),V={row:{margin:"20px 4px 20px"},special:{fontFamily:'Roboto, "Helvetica Neue", Helvetica, Tahoma, Arial, "PingFang SC", "Microsoft YaHei"',fontSize:"12px",lineHeight:"1.28571",color:"#333333",alignSelf:"center",fontWeight:"600"}},T=t.a=L},979:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),o=r(68),i=r.n(o),l=r(158),c=r(90),s=r(42),u=r(200),f=r(22),p=r(38),h=r(12),d=r(156),m=r(69),y=r(157),g=r(83),b=r(82),v=r(21),S=r(134),w=r(47),O=r(74),E=r(25),D=r(23),C=r(269),P=r(898),F=r(56),j=r.n(F),x=r(13),k=r(384),R=r(105),L,V;function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t,r){return t&&I(e.prototype,t),r&&I(e,r),e}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}function J(e,t){return(J=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function M(e){var t=U();return function r(){var n=z(e),a;if(t){var o=z(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return K(this,a)}}function K(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var q=w.a.Row,Z=w.a.Col,Y=Object(E.withRouter)(L=V=function(e){W(r,e);var t=M(r);function r(){var e;B(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={isLoading:!1,pageData:[],filterDataSource:[],dataSource:[],isMobile:!1,visable:!1,value:{},topicInfo:[]},e.componentWillUnmount=function(){e.mounted=!1},e.fetchData=function(t){e.setState({isLoading:!0},(function(){D.a.get("/manager/group?cluster=".concat(t)).then((function(t){if(200===t.data.code){var r=Object(k.e)(t.data.data,"consummerGroup","asc");e.mounted&&e.setState({filterDataSource:r,dataSource:r,isLoading:!1})}else e.setState({isLoading:!1}),v.a.error({content:t.data.message,duration:1e4,closeable:!0})})).catch((function(t){e.setState({isLoading:!1}),v.a.error({content:t,duration:1e4,closeable:!0})}))}))},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.handleParaChange=function(t){var r=e.filterComponent.getFilterData(e.state.dataSource),n=e.filterByPagePara(r,t);e.setState({filterDataSource:n})},e.consumerApiFilter=function(t){var r;Object.keys(t).forEach((function(e){var n=t[e].selectedKeys;n.length&&(r=n)})),Object(O.isNullOrUndefined)(r)&&(r="ALL"),r=r.toString(),e.handleParaChange(r)},e.renderGroup=function(t,r,n){return a.a.createElement("div",null,a.a.createElement("a",{style:Q.groupLink,onClick:function t(){return e.handelDetail(n)}},n.consummerGroup))},e.redrawPageData=function(t){e.setState({pageData:t})},e.handleDeleteGroup=function(t){g.a.confirm({title:"Delete Group",content:"confirm delete this group: ".concat(t.consummerGroup,"?"),onOk:function r(){return e.deleteGroup(t)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.handleRestOffset=function(t){var r={};r.group=t.consummerGroup,r.clusterId=t.clusterID,r.topic="",e.fetchTopic(r).then((function(t){e.setState({value:r,visable:!0,topicInfo:t})}))},e.fetchTopic=function(e){return new Promise((function(t,r){D.a.post("/manager/group/topic",e).then((function(e){if(200===e.data.code){var r=[],n;e.data.data.map((function(e){r.push({label:e,value:e})})),t(r)}})).catch((function(e){console.log("error",e)}))}))},e.onOk=function(){var t;(0,e.refs.form.validateFields)((function(t,r){if(!t){var n=e.state.value;n.clusterId=e.state.value.clusterId,D.a.post("/manager/group/rest/offset",n).then((function(t){200===t.data.code&&(v.a.success(t.data.message),e.handelDialog())})).catch((function(e){console.log("error",e)}))}}))},e.handelDialog=function(){e.setState({visable:!e.state.visable})},e.renderRestDialog=function(){var t=e.state.isMobile,r=G({},Q.simpleFormDialog);t&&(r.width="300px");var n={children:"OK"},o={children:"Cancel"};return a.a.createElement("div",null,a.a.createElement(g.a,{className:"simple-form-dialog",style:r,autoFocus:!1,footerAlign:"center",title:"Reset Offset",onOk:e.onOk,onCancel:e.handelDialog,onClose:e.handelDialog,isFullScreen:!0,visible:e.state.visable,okProps:n,cancelProps:o},a.a.createElement(x.FormBinderWrapper,{ref:"form",value:e.state.value,onChange:e.onFormChange},a.a.createElement("div",{style:Q.dialogContent},a.a.createElement(q,{style:Q.formRow},a.a.createElement(Z,{span:"".concat(t?"6":"4")},a.a.createElement("label",{style:Q.formLabel},"Group:")),a.a.createElement(Z,{span:"".concat(t?"18":"16")},a.a.createElement(x.FormBinder,{name:"group",required:!0},a.a.createElement("span",null,e.state.value.group)),a.a.createElement(x.FormError,{name:"group"}))),a.a.createElement(q,{style:Q.formRow},a.a.createElement(Z,{span:"".concat(t?"6":"4")},a.a.createElement("label",{style:Q.formLabel},"Topic Name:")),a.a.createElement(Z,{span:"".concat(t?"18":"16")},a.a.createElement(x.FormBinder,{name:"topic",required:!0},a.a.createElement(m.a,{showSearch:!0,dataSource:e.state.topicInfo,placeholder:"please select topic",style:{width:"100%"}})),a.a.createElement("span",{style:{color:"red",fontWeight:"500"}},"Please stop group consumption first, otherwise offset reset is invalid!"),a.a.createElement(x.FormError,{name:"topic"})))))))},e.deleteGroup=function(t){e.setState({isLoading:!0},(function(){D.a.post("/manager/delete/group",t).then((function(t){200===t.data.code?e.fetchData(Object(R.a)("kafkaManagerGroup").id):(v.a.error({content:t.data.message,duration:1e4,closeable:!0}),e.setState({isLoading:!1}))})).catch((function(t){console.error(t),e.setState({isLoading:!1}),v.a.error({content:"delete Group is error, please contact maintenance staff!",duration:1e4,closeable:!0})}))}))},e.renderDeleteGroup=function(t,r,n){return a.a.createElement("div",null,a.a.createElement("span",{title:"reset offset",style:Q.operBtn,onClick:function t(){e.handleRestOffset(n)}},a.a.createElement(j.a,{size:"xxs",type:"exchange"})),a.a.createElement("span",{style:Q.separator}),a.a.createElement("span",{title:"Delete this Group",style:Q.operBtn},a.a.createElement(h.a,{size:"xxs",type:"close",onClick:function t(){e.handleDeleteGroup(n)}})))},e.handelDetail=function(t){e.props.history.push("/monitor/consumer/group/detail/".concat(t.clusterID,"/").concat(t.clusterName,"/").concat(t.consummerGroup))},e.filterByPagePara=function(t,r){var n=t;return Object(O.isNullOrUndefined)(r)||"ALL"===r||""===r||(n=e.searchdata(n,"consumereApi",r)),n},e.searchdata=function(e,t,r){return e.filter((function(e){return-1!==e[t].toLocaleLowerCase().search(r.toLocaleLowerCase())}))},e.onRef=function(t){e.filterComponent=t},e}return A(r,[{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"onSort",value:function e(t,r){var n=Object(k.e)(this.state.filterDataSource,t,r);this.refreshTableData(n)}},{key:"render",value:function e(){var t=this,r=this.state.isLoading,n=this.renderRestDialog();return a.a.createElement("div",null,a.a.createElement(s.a,{visible:r,style:Q.loading},a.a.createElement(P.a,{dataSource:this.state.dataSource,refreshTableData:this.refreshTableData,refreshDataSource:this.fetchData,selectTitle:"Cluster",selectField:"clusterName",searchTitle:"Filter",searchField:"consummerGroup",searchPlaceholder:"Input Group Name",id:"kafkaManagerGroup",onRef:this.onRef}),a.a.createElement(f.a,{dataSource:this.state.pageData,hasBorder:!1,onSort:function e(r,n){return t.onSort(r,n)},onFilter:this.consumerApiFilter},a.a.createElement(f.a.Column,{title:"Group Name",dataIndex:"consummerGroup",cell:this.renderGroup,sortable:!0}),a.a.createElement(f.a.Column,{title:"Consumer Api",dataIndex:"consumereApi",filters:[{label:"ZK",value:"ZK"},{label:"BROKER",value:"BROKER"}],filterMode:"single"}),a.a.createElement(f.a.Column,{title:"Cluster",dataIndex:"clusterName"}),a.a.createElement(f.a.Column,{title:"Operation",cell:this.renderDeleteGroup})),a.a.createElement(C.a,{dataSource:this.state.filterDataSource,redrawPageData:this.redrawPageData})),n)}}]),r}(n.Component))||L,Q={groupLink:{margin:"0 5px",color:"#1111EE",cursor:"pointer",textDecoration:"none"},loading:{width:"100%"},separator:{margin:"0 8px",display:"inline-block",height:"12px",width:"1px",verticalAlign:"middle",background:"#e8e8e8"},operBtn:{display:"inline-block",width:"24px",height:"24px",borderRadius:"999px",color:"#929292",background:"#f2f2f2",textAlign:"center",cursor:"pointer",lineHeight:"24px",marginRight:"6px"},formRow:{marginTop:20},simpleFormDialog:{width:"640px"},formLabel:{lineHeight:"26px"}};function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function te(e,t,r){return t&&ee(e.prototype,t),r&&ee(e,r),e}function re(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}function ne(e,t){return(ne=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function ae(e){var t=le();return function r(){var n=ce(e),a;if(t){var o=ce(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return oe(this,a)}}function oe(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?ie(e):t}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var se=function(e){re(r,e);var t=ae(r);function r(){return $(this,r),t.apply(this,arguments)}return te(r,[{key:"render",value:function e(){var t=[{link:"",text:"Kafka Manager"},{link:"",text:"Group"}];return a.a.createElement("div",null,a.a.createElement(l.a,{items:t,title:"Group List"}),a.a.createElement(i.a,{style:ue.container},a.a.createElement(Y,null)))}}]),r}(n.Component),ue={container:{margin:"20px",padding:"10px 20px 20px",minHeight:"600px"}},fe=t.default=se}}]);